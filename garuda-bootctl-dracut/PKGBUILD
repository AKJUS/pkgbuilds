# Maintainer: dr460nf1r3 <dr460nf1r3 at garudalinux dot org>
# Contributor: Librewish <librewish@gmail.com>

pkgname=garuda-bootctl-dracut
pkgdesc="Systemd-boot, Dracut and Secure Boot support for Garuda Linux"
pkgver=0.0.5
pkgrel=1
arch=('any')
license=('GPL')
depends=('pacman' 'systemd' 'dracut' 'sbsigntools' 'sbctl' 'tpm2-tss' 'tpm2-tools' 'dracut-hook-uefi')
provides=('mkinitpcio' 'grub' 'grub-btrfs')
backup=(etc/dracut.conf.d/dracut-garuda.conf)
install="$pkgname".install
source=(bootctl-update.hook
	dracut-garuda.conf
	gen-dracut-cmdline)
md5sums=('d52c4428f6b99a634c81224cffc76541'
	'09f090a8383d5e4a9f39c319c6d1db8a'
	'e77df34568e2adc1ea8f083162dc1821')

package() {
	cd $srcdir
	install -d "$pkgdir/usr/share/libalpm/hooks"
	install -Dm644 bootctl-update.hook "$pkgdir/usr/share/libalpm/hooks/bootctl-update.hook"

	install -d "$pkgdir/etc/dracut.conf.d"
	install -Dm644 dracut-garuda.conf "$pkgdir/etc/dracut.conf.d/dracut-garuda.conf"

	install -d "$pkgdir/usr/bin"
	install -Dm755 gen-dracut-cmdline "$pkgdir/usr/bin/gen-dracut-cmdline"
}
